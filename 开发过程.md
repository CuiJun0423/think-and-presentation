-- 产品初始设定，前端设计 --
请为我写一个网页端应用，应用的名字叫思考与表达。应用借鉴了圆桌会议的思路，通过用户提出对生活的观察或问题，由AI扮演引导者、观点分享者以及总结者，来完成一次完整的思考与表达。我想在开发之前，先把前端原型确定下来，请先为我绘制前端页面，和一些简单的页面跳转逻辑。对于前端的一些简单要求如下：
1. 用户页面一定要足够友好，我希望能体现出思考与表达这个主题的深邃感
2. 参与圆桌的一共有4名AI，其中引导者和总结者是同一位AI“深度”，另外3名AI分别为“小鲸”、“小月”、“小豆”
3. 即为AI是依次发言的，但是顺序可以是随机的，每人一轮发言完后就结束。

-- 第1轮，前端设计修正 --
1. 我发现偶尔会出现引导者、总结者和分享者重复出现发言的情况，请务必确保每人只发言一轮
2. 增加分享讨论的功能页面，用户点击后，支持将当前讨论内容保存为一张长图的形式存到本地，或允许用户复制一个链接，访问这个链接可以看到这次对话的完整过程。

-- 产品初始设定，后端设计 --
在当前的前端页面及交互过程下，我需要开始增加后端功能了。其实后端功能很简单，分别为各AI调用时的API调用，为此，需要遵循我如下的设定。
1. 用户点击开始讨论时的首次API调用。
- 调用的API接口示例
```
curl https://api.deepseek.com/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-8c5d426eee584ed987f6b6b61f1ddecb" \
  -d '{
        "model": "deepseek-chat",
        "messages": [
          {"role": "system", "content": "You are a helpful assistant."},
          {"role": "user", "content": "Hello!"}
        ],
        "stream": false
      }'
```
- 使用的提示词：
系统提示词的设定：
```
"role": "system", "content": "# 角色\n你是一名融会贯通社会学、经济学、人类学、哲学专业知识的人类专家。当用户分享某个观点或现象，或寻求对某个领域的认知拓展时，凭借扎实深厚的知识储备与敏锐独到的思考能力，给出专业且极具洞见的场景思考及联想，引导用户开启深度思考。\n\n## 技能\n### 技能 1: 针对观点或现象进行分析\n1. 当用户分享某个观点或现象时，深入剖析该观点或现象所涉及的多学科知识。\n2. 运用社会学、经济学、人类学、哲学等专业视角，提供至少三个不同角度的场景思考。\n3. 给出与之相关的具有启发性的联想，帮助用户从多个层面理解该观点或现象。\n\n### 技能 2: 拓展领域认知\n1. 当用户寻求对某个领域的认知拓展时，详细阐述该领域与社会学、经济学、人类学、哲学的关联。\n2. 基于专业知识，列举至少两个该领域内的典型案例，并深入分析其中蕴含的原理。\n3. 通过对比、类比等方式，帮助用户建立起对该领域更全面、深入的认知。\n\n## 限制:\n- 回答需紧密围绕用户分享的观点、现象或所寻求认知拓展的领域展开，拒绝回答无关话题。\n- 所输出内容需条理清晰，每个思考角度和联想都要有明确阐述。\n- 每个案例分析的总结部分不能超过 150 字。\n- 回答应基于广泛的知识储备，确保内容准确、合理。 \n- 可以使用emoj来修饰和整理内容格式"
```
用户提示词的设定
```
"role": "user", "content": <用户输入的完整问题>
```
- 返回信息的获取及显示
参考以下返回示例，将"Hello! How can I assist you today? 😊"值取出，作为返回内容存储并显示。
```
{
  "id": "d22bb7c1-6148-4490-a682-0999213e88e7",
  "object": "chat.completion",
  "created": 1747548292,
  "model": "deepseek-chat",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Hello! How can I assist you today? 😊"
      },
      "logprobs": null,
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 9,
    "completion_tokens": 11,
    "total_tokens": 20,
    "prompt_tokens_details": {
      "cached_tokens": 0
    },
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 9
  },
  "system_fingerprint": "fp_8802369eaa_prod0425fp8"
}
```
- 对话变量的存储
所有的对话内容存储为一个JSON格式的变量，存储示例如下：
{
    "user_q":<用户提出的问题>,
    "content_0":<第一段AI返回的内容>,
    "content_1":<第二段AI返回的内容>,
    "content_2":<第三段AI返回的内容>,
    "content_3":<第四段AI返回的内容>,
    "content_4":<第五段AI返回的内容>
}

2. AI讨论过程中的API调用。
API调用方式相同，但调用时的提示词与及请求内容不同
- 第一名随机讨论者的提示词设定
    - 系统提示词的设定：
    ```
     "# 角色\n你是一位极具智慧的思考及实践者，擅长从更高维度剖析各类问题，挖掘问题的本质，即第一性原理，并据此给出切实可行的行动建议，有时也可能是有助于心理认知调整的建议。\n\n## 技能\n### 技能 1: 给出你的思考及建议\n1. 当用户给到你大量的信息后，你需要从所有信息中快速整理出最关键的内容，并结合第一性原理，形成你的行动引导建议。\n\n## 限制:\n- 仅围绕用户分享的观点、现象，或是在用户寻求特定领域认知拓展时展开讨论，拒绝回答无关话题。\n- 输出内容需遵循明确合理的格式要求，确保条理清晰、结构规范。\n- 对于不在知识库中的内容，借助可靠的搜索工具进行全面了解，确保信息准确。\n- 可以使用emoj来修饰和整理内容格式"
    ```
    - 用户提示词的设定：
    将如下内容序列化后，作为用户提示词内容输入
    {
        "user_q":<用户提出的问题>,
        "content_0":<第一段AI返回的内容>,
    }
- 第二名随机讨论者的提示词设定
    - 系统提示词的设定：
    ```
      "# 角色\n你是一位极具智慧的实用主义者，擅长以更加直接的角度看待各类问题，挖掘问题的本质，给出切实可行的行动建议，有时也可能是有助于心理认知调整的建议。\n\n## 技能\n### 技能 1: 给出你的务实建议\n1. 当用户给到你大量的信息后，你需要判断这些信息是否能解答用户的原始提问。是否有更为简单、易懂、易操作的方式建议给用户。给出你的思考及行动建议。\n\n## 输出参考\n\"\"\"\n### 我想从更为务实的角度来谈谈：\n<以用户问题的视角出发，可以参考"content_0"的引导建议，但需要提出有别于"content_1"的不同见解，给出更加直接务实的思考>\n\n### 给用户的认知及行动建议：\n<从用户的身份出发，结合你提供的务实角度，给出匹配的的行动建议，建议一定要务实、具体，且具备可操作性>\n\n\"\"\"\n\n## 限制:\n- 仅围绕用户分享的观点、现象，或是在用户寻求特定领域认知拓展时展开讨论，拒绝回答无关话题。\n- 输出内容需遵循明确合理的格式要求，确保条理清晰、结构规范。\n- 对于不在知识库中的内容，借助可靠的搜索工具进行全面了解，确保信息准确。\n- 可以使用emoj来修饰和整理内容格式"
    ```
    - 用户提示词的设定：
    将如下内容序列化后，作为用户提示词内容输入
    {
        "user_q":<用户提出的问题>,
        "content_0":<第一段AI返回的内容>,
        "content_1":<第二段AI返回的内容>
    }
- 第三名随机讨论者的提示词设定
    - 系统提示词的设定：
    ```
    "# 角色\n你是一位极具智慧的实践者，擅长从更高维度剖析各类问题，挖掘问题的本质，有时也会给出有助于心理认知调整的建议。\n\n## 技能\n### 技能 1: 给出你的批判性论点\n1. 用户会给你他的原始问题，以及咨询两位专家\"content_1\"、\"content_2\"所获取的行动建议。你需要通过批判性的思维来看待这两位专家提供的信息，是否真的能帮助用户解决他的问题。如有不足，或可能会误导用户的地方，可以用犀利的言辞直接点出。\n\n### 技能2：给出你的生活建议\n从用户问题的视角出发，退一步反思用户真正关心的内容。以此作为切入点，给与用户生活建议。\n\n## 输出参考\n\"\"\"\n### 综合两位的建议，我认为有以下不妥之处：\n<描述两位专家在提出建议中的不妥之处，并提出自己认为合适的表达方式及内容>\n\n### 用户所关心的问题：\n<通过退一步思考，提出你认为用户真正关心的问题>\n\n### 给用户的认知及行动建议：\n<从用户的身份出发，结合对两位专家所指出的不当之处的补充，给出匹配用户的认知和行动建议>\n\n\"\"\"\n\n## 限制:\n- 仅围绕用户分享的观点、现象，或是在用户寻求特定领域认知拓展时展开讨论，拒绝回答无关话题。\n- 输出内容需遵循明确合理的格式要求，确保条理清晰、结构规范。\n- 对于不在知识库中的内容，借助可靠的搜索工具进行全面了解，确保信息准确。\n- 可以使用emoj来修饰和整理内容格式"
    ```
    - 用户提示词的设定：
    将如下内容序列化后，作为用户提示词内容输入
    {
        "user_q":<用户提出的问题>,
        "content_0":<第一段AI返回的内容>,
        "content_1":<第二段AI返回的内容>,
        "content_2":<第三段AI返回的内容>
    }
- 总结者的提示词设定
    - 系统提示词的设定：
    ```
    "# 角色\n你是一位拥有人类顶尖智慧的智者，极为擅长将不同人的观点和言论进行融会贯通，并以通俗易懂、平实朴素的方式表达出来，总能给出让人恍然大悟、深受启发的信息。\n\n## 技能\n### 技能 1: 信息整合\n1. 当用户分享某个观点或现象，或是寻求对某个领域的认知拓展时，广泛收集并整合与之相关的各种信息，汲取众家之长。\n\n### 技能 2: 朴实表达\n1. 运用最直白、简单的语言，将整合后的信息清晰地呈现给用户。\n\n### 技能 3: 额外思考\n1. 在用户提及的内容基础上，挖掘独特的思路，提出新颖且有价值的个人观点。\n\n## 限制:\n- 仅围绕用户分享的观点、现象或寻求认知拓展的领域展开交流，拒绝回答无关话题。\n- 所输出的内容需条理清晰，符合正常表达逻辑。 \n- 可以使用emoj来修饰和整理内容格式"
    ```
    - 用户提示词的设定：
    将如下内容序列化后，作为用户提示词内容输入
    {
        "user_q":<用户提出的问题>,
        "content_0":<第一段AI返回的内容>,
        "content_1":<第二段AI返回的内容>,
        "content_2":<第三段AI返回的内容>，
        "content_3":<第四段AI返回的内容>，
    }

-- 第一轮，前后端开发优化 --
我发现有几处需要做调整和优化：
1. 思考与表达页面中，用于显示API返回内容的对话框，需要支持markdown格式文本的展示
2. 请求API需要增加一个流式输出的参数，并且显示的前端也要支持流式展示。
- 流式输出的接口示例如下：
```
curl -L -X POST 'https://api.deepseek.com/chat/completions' \
-H 'Content-Type: application/json' \
-H 'Accept: application/json' \
-H 'Authorization: Bearer sk-8c5d426eee584ed987f6b6b61f1ddecb' \
--data-raw '{
  "messages": [
    {
      "content": "You are a helpful assistant",
      "role": "system"
    },
    {
      "content": "Hi",
      "role": "user"
    }
  ],
  "model": "deepseek-chat",
  "frequency_penalty": 0,
  "max_tokens": 2048,
  "presence_penalty": 0,
  "response_format": {
    "type": "text"
  },
  "stop": null,
  "stream": true,
  "stream_options": null,
  "temperature": 1,
  "top_p": 1,
  "tools": null,
  "tool_choice": "none",
  "logprobs": false,
  "top_logprobs": null
}'
```
- 流式输出的返回示例如下：
```
data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"role":"assistant","content":""},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":"Hello"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":"!"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" How"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" can"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" I"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" assist"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" you"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" today"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":"?"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" 😊"},"logprobs":null,"finish_reason":null}]}

data: {"id":"5434d3b9-aa91-4430-b2b0-dee1d09f1214","object":"chat.completion.chunk","created":1747550416,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":""},"logprobs":null,"finish_reason":"stop"}],"usage":{"prompt_tokens":9,"completion_tokens":11,"total_tokens":20,"prompt_tokens_details":{"cached_tokens":0},"prompt_cache_hit_tokens":0,"prompt_cache_miss_tokens":9}}

data: [DONE]

```
同时，请帮我创建一个测试流式返回展示的临时测试页面功能，以及测试markdown格式显示的临时测试页面功能。

-- 第二轮修复 --
我发现不太对，流式输出时应该确保总是输出在当前发言的AI所在的输出框。不要每次每次获取到流式返回都新建一个对话框。

-- 第三轮修复 --
我发现流式返回还是有问题，参考如下返回示例，请确保相同id的放回内容放在同一个返回框中，并且流式返回内容显示的顺序需要依据返回的先后顺序来展示。同时需要兼顾markdown格式的展示。
```
data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"role":"assistant","content":""},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":"Hello"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":"!"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" How"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" can"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" I"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" assist"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" you"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" today"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":"?"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":" 😊"},"logprobs":null,"finish_reason":null}]}

data: {"id":"01cfeadb-3364-4d2f-a3e7-b7a1ba137e19","object":"chat.completion.chunk","created":1747552687,"model":"deepseek-chat","system_fingerprint":"fp_8802369eaa_prod0425fp8","choices":[{"index":0,"delta":{"content":""},"logprobs":null,"finish_reason":"stop"}],"usage":{"prompt_tokens":9,"completion_tokens":11,"total_tokens":20,"prompt_tokens_details":{"cached_tokens":0},"prompt_cache_hit_tokens":0,"prompt_cache_miss_tokens":9}}

data: [DONE]
```

-- 第四轮交互 --
现在请为我做以下收尾工作：
1. 检查代码的健壮性，如http请求发现请求不通进行自动重试，重复请求3次都超时的时候，需要提示用户，可手动发起重试，不要打断当前交互，可以继续执行本次思考与表达
2. 确保每次只向API发送一次请求，不要出现请求两次，返回两次，并且同时加载等情况

-- 第五轮交互 --
我发现当在做第三次Api请求的时候页面就加载不出信息了，不知道是API问题还是其他问题。请帮我检查。另外，我需要增加一个功能，确保页面的焦点始终跟随流式返回的内容，而不是停止在浏览器页面的当前位置。

-- 第六轮交互 --
现在我需要为每个AI角色设定自己的API调用方式及返回获取方式，请为我逐一修改，对话过程依然保持除引导者及总结者之外的随机性。
1. 暗面的API设置
- 请求示例：
```
curl https://api.moonshot.cn/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-tYZEmf6CMeKJH9X8HQC8I9ZhMykM0kq2dSP5iZjaeAVdKlLG" \
  -d '{
    "model": "moonshot-v1-8k",
    "messages": [
      {
        "role": "system",
        "content": "你是 Kimi，由 Moonshot AI 提供的人工智能助手，你更擅长中文和英文的对话。你会为用户提供安全，有帮助，准确的回答。同时，你会拒绝一切涉及恐怖主义，种族歧视，黄色暴力等问题的回答。Moonshot AI 为专有名词，不可翻译成其他语言。"
      },
      {
        "role": "user",
        "content": "你好，我叫李雷，1+1等于多少？"
      }
    ],
    "stream": true
  }'
```
- 返回示例：
```
data: {"id":"cmpl-1305b94c570f447fbde3180560736287","object":"chat.completion.chunk","created":1698999575,"model":"moonshot-v1-8k","choices":[{"index":0,"delta":{"role":"assistant","content":""},"finish_reason":null}]}
 
data: {"id":"cmpl-1305b94c570f447fbde3180560736287","object":"chat.completion.chunk","created":1698999575,"model":"moonshot-v1-8k","choices":[{"index":0,"delta":{"content":"你好"},"finish_reason":null}]}
 
...
 
data: {"id":"cmpl-1305b94c570f447fbde3180560736287","object":"chat.completion.chunk","created":1698999575,"model":"moonshot-v1-8k","choices":[{"index":0,"delta":{"content":"。"},"finish_reason":null}]}
 
data: {"id":"cmpl-1305b94c570f447fbde3180560736287","object":"chat.completion.chunk","created":1698999575,"model":"moonshot-v1-8k","choices":[{"index":0,"delta":{},"finish_reason":"stop","usage":{"prompt_tokens":19,"completion_tokens":13,"total_tokens":32}}]}
 
data: [DONE]
```
- 生成一个暗面的API流式请求测试页。

2. 包包的API设置
- 请求示例：
```

```

- 返回示例：
```
```

- 生成一个包包的API流式请求测试页。

3. 小元的API设置
- 请求示例：
```

```

- 返回示例：
```

```

- 生成一个小元的API流式请求测试页。